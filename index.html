<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>2026 새해 복 많이 받으세요</title>
<style>
*{margin:0;padding:0;overflow:hidden}
body{background:#05001a;width:100vw;height:100vh;cursor:pointer}
canvas{position:absolute;top:0;left:0}
.greeting{
  position:absolute;
  top:35%;left:50%;
  transform:translateX(-50%);
  font-size:28px;
  color:white;
  opacity:0;
  transition:opacity 3s linear;
}
</style>
</head>
<body>
<div class="greeting" id="greet">새해 복 많이 받으세요</div>
<canvas id="cv"></canvas>

<!-- 音效 -->
<audio id="sound1" src="1.mp3" preload="auto"></audio>
<audio id="sound2" src="2.mp3" preload="auto"></audio>
<audio id="sound3" src="3.mp3" preload="auto"></audio>

<script>
const cv=document.getElementById("cv"),ctx=cv.getContext("2d");
cv.width=innerWidth; cv.height=innerHeight;
let rockets=[],parts=[];

let allowSound1 = true;
let allowSound2 = true;

// Rocket 烟花升空
class Rocket{
  constructor(x,t){
    this.x=x; this.y=cv.height; this.t=t;
    if(allowSound1){
      const s1=document.getElementById('sound1');
      s1.currentTime=0; s1.play().catch(()=>{});
    }
  }
  update(){
    this.y-=6;
    if(this.y<=this.t){explode(this.x,this.y); return false;}
    return true;
  }
  draw(){ctx.fillStyle="#fff"; ctx.fillRect(this.x,this.y,2,6);}
}

// 烟花爆炸粒子
class Particle{
  constructor(x,y){
    this.x=x; this.y=y;
    this.vx=(Math.random()-.5)*8; this.vy=(Math.random()-.5)*8; this.a=1;
  }
  update(){
    this.x+=this.vx; this.y+=this.vy; this.vy+=.05; this.a-=.015;
    return this.a>0;
  }
  draw(){
    ctx.globalAlpha=this.a;
    ctx.fillStyle=`hsl(${Math.random()*360},100%,60%)`;
    ctx.fillRect(this.x,this.y,3,3);
    ctx.globalAlpha=1;
  }
}

function explode(x,y){
  if(allowSound2){
    const s2=document.getElementById('sound2');
    s2.currentTime=0; s2.play().catch(()=>{});
  }
  const s3=document.getElementById('sound3');
  s3.currentTime=0; s3.play().catch(()=>{});
  for(let i=0;i<80;i++) parts.push(new Particle(x,y));
}

function animate(){
  ctx.fillStyle="rgba(5,0,26,.25)";
  ctx.fillRect(0,0,cv.width,cv.height);
  rockets=rockets.filter(r=>r.update());
  rockets.forEach(r=>r.draw());
  parts=parts.filter(p=>p.update());
  parts.forEach(p=>p.draw());
  requestAnimationFrame(animate);
}

// 控制文字淡出
const g=document.getElementById("greet");
setTimeout(()=>{
  g.style.opacity=1;
  setTimeout(()=>g.style.opacity=0,3000); // 3秒淡出
},3000); // 3秒后出现

// 烟花生成
const fireworkInterval = setInterval(()=>{
  if(allowSound1 || allowSound2) rockets.push(new Rocket(Math.random()*cv.width,Math.random()*cv.height*0.4));
},700);

// 25秒后取消所有声音，保留音效1和音效2
setTimeout(()=>{
  const s3=document.getElementById('sound3');
  s3.pause(); s3.currentTime=0; // 停止音效3
},25000);

// 30秒后音效1和音效2完全消失
setTimeout(()=>{
  allowSound1=false;
  allowSound2=false;
},30000);

document.body.addEventListener("click",()=>{
  animate();
},{once:true});
</script>
</body>
</html>
